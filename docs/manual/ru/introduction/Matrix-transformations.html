<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<base href="../../../" />
		<script src="page.js"></script>
		<link type="text/css" rel="stylesheet" href="page.css" />
	</head>
	<body>
		<h1>Матричные преобразования ([name])</h1>

		<p>
		Three.js использует `matrices` для кодирования 3D-преобразований — перемещения  
		(положения), вращения и масштабирования. Каждый экземпляр [page:Object3D] имеет [page:Object3D.matrix matrix], В
		которой хранятся положение, вращение и масштаб объекта. На этой странице описано, как
		обновить преобразование объекта. 
		</p>

		<h2>Удобные свойства и `matrixAutoUpdate`</h2>

		<p>
			Существует два способа обновить преобразование объекта: 
		</p>
		<ol>
			<li>
				Изменить объект `position`, `quaternion`, и `scale` свойства, и пусть three.js пересчитает 
				матрицу объекта из этих свойств: 
				<code>
object.position.copy( start_position );
object.quaternion.copy( quaternion );
				</code>
				По умолчанию `matrixAutoUpdate` свойство установлено true, и матрица будет автоматически 
				пересчитана. Если объект статический или вы хотите вручную контролировать время 
				пересчета, то лучшую производительность можно получить, установив свойство false: 
				<code>
object.matrixAutoUpdate = false;
				</code>
				И после изменения каких-либо свойств обновите матрицу вручную: 
				<code>
object.updateMatrix();
				</code>
			</li>
			<li>
				Измените матрицу объекта напрямую. Класс [page:Matrix4] имеет различные методы для изменения
				матрицы: 
				<code>
object.matrix.setRotationFromQuaternion( quaternion );
object.matrix.setPosition( start_position );
object.matrixAutoUpdate = false;
				</code>
				Обратите внимание, что `matrixAutoUpdate` <em>должен</em> быть установлен на `false` в этом случае,
				и вам следует убедиться, что вы не вызываете `updateMatrix`. Вызывая `updateMatrix` заблокируется
				внесенная вручную изменения в матрицу, пересчитывая матрицу из `position`, `scale`, и так
				далее.  				 
			</li>
		</ol>

		<h2>Матрицы объектов и миров</h2>
		<p>
		Объект [page:Object3D.matrix matrix] хранит преобразование объекта <em>относительно</em> объекта [page:Object3D.parent parent]; чтобы
		получить преобразование объекта в <em>мировые</em> кооординаты, вы должны получить доступ к [page:Object3D.matrixWorld].
		</p>
		<p>
		Когда изменяется преобразования родительского или дочернего объекта, вы можете запросить
		обновление [page:Object3D.matrixWorld matrixWorld] дочернего объекта, вызвав [page:Object3D.updateMatrixWorld updateMatrixWorld]().
		</p>
		<p>
		Объект можно преобразовать с помощью [page:Object3D.applyMatrix4]. Примечание: На самом деле
		этот метод основан на [page:Matrix4.decompose], и не все матрицы можно разложить таким образом.
		Например, если объект имеет неравномерно масштабируемый родительский объект, то
		мировая матрица объекта может быть неразложимой, и этот метод может оказаться
		неприемлемым.   
		</p>

		<h2>Вращение и кватернион</h2>
		<p>
		Three.js предоставляет два способа представления трехмерного вращения: [page:Euler Euler angles] и
		[page:Quaternion Quaternions], а также методы преобразования между ними. Euler angles подвержены
		проблеме, называемой "замком кардана", когда определенные конфигурации могут терять степень свободы (предотвращая вращение объекта вокруг одной оси). По этой причине 
		вращения объекта <em>всегда</em> хранится в памяти объекта [page:Object3D.quaternion quaternion].
		</p>
		<p>
		Предыдущие версии библиотеки включали свойство  `useQuaternion` объекта, которое, если
		установлено значение false, это приведет к тому, что [page:Object3D.matrix matrix] будет рассчитываться под Euler 
		angles. Эта практика устарела — вместо этого вам следует использовать метод
		[page:Object3D.setRotationFromEuler setRotationFromEuler], который обновит кватернион. 
		</p>

	</body>
</html>
