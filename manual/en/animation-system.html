<!DOCTYPE html><html lang="fr"><head>
    <meta charset="utf-8">
    <title>Système d'animation</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@threejs">
    <meta name="twitter:title" content="Three.js – Système d'animation">
    <meta property="og:image" content="https://threejs.org/files/share.png">
    <link rel="shortcut icon" href="../../files/favicon_white.ico" media="(prefers-color-scheme: dark)">
    <link rel="shortcut icon" href="../../files/favicon.ico" media="(prefers-color-scheme: light)">

    <link rel="stylesheet" href="../resources/lesson.css">
    <link rel="stylesheet" href="../resources/lang.css">
<script type="importmap">
{
  "imports": {
    "three": "../../build/three.module.js"
  }
}
</script>
  </head>
  <body>
    <div class="container">
      <div class="lesson-title">
        <h1>Système d'animation</h1>
      </div>
      <div class="lesson">
        <div class="lesson-main">

          <h2>Aperçu</h2>

		<p class="desc">
			Dans le système d'animation three.js, vous pouvez animer diverses propriétés de vos modèles :
			les os d'un modèle skinné et riggé, les cibles de morphing, différentes propriétés de matériaux
			(couleurs, opacité, booléens), la visibilité et les transformations. Les propriétés animées peuvent être fondues en entrée,
			fondues en sortie, croisées et déformées. Les poids et échelles de temps des différentes animations simultanées
			sur le même objet ainsi que sur des objets différents peuvent être modifiés
			indépendamment. Diverses animations sur le même objet et sur des objets différents peuvent être
			synchronisées.<br /><br />

			Pour réaliser tout cela dans un système homogène, le système d'animation three.js
			[link:https://github.com/mrdoob/three.js/issues/6881 a complètement changé en 2015]
			(attention aux informations obsolètes !), et il a maintenant une architecture similaire à
			Unity/Unreal Engine 4. Cette page donne un bref aperçu des principaux composants du
			système et de la façon dont ils fonctionnent ensemble.

		</p>

		<h3>Clips d'animation</h3>

		<p class="desc">

			Si vous avez importé avec succès un objet 3D animé (peu importe s'il a
			des os ou des cibles de morphing ou les deux) — par exemple en l'exportant depuis Blender avec l'
			[link:https://github.com/KhronosGroup/glTF-Blender-IO exportateur glTF Blender] et
			en le chargeant dans une scène three.js en utilisant `GLTFLoader` — l'un des champs de réponse
			devrait être un tableau nommé "animations", contenant les clips d'animation
			pour ce modèle (voir une liste des chargeurs possibles ci-dessous).<br /><br />

			Chaque `AnimationClip` contient généralement les données pour une certaine activité de l'objet. Si le
			maillage est un personnage, par exemple, il peut y avoir un AnimationClip pour un cycle de marche, un deuxième
			pour un saut, un troisième pour un déplacement latéral, et ainsi de suite.

		</p>

		<h3>Pistes d'images-clés</h3>

		<p class="desc">

			À l'intérieur d'un tel `AnimationClip`, les données de chaque propriété animée sont stockées dans une
			`KeyframeTrack` séparée. En supposant qu'un objet personnage possède un squelette,
			une piste d'images-clés pourrait stocker les données des changements de position de l'os de l'avant-bras
			au fil du temps, une autre piste les données des changements de rotation du même os, une troisième
			la position, la rotation ou la mise à l'échelle d'un autre os, et ainsi de suite. Il devrait être clair,
			qu'un AnimationClip peut être composé de nombreuses pistes de ce type.<br /><br />

			En supposant que le modèle possède des cibles de morphing (par exemple une cible de morphing
			montrant un visage amical et une autre montrant un visage en colère), chaque piste contient les
			informations sur la façon dont l'influence d'une certaine cible de morphing change pendant l'exécution
			du clip.

		</p>

		<h3>Mixeur d'animation</h3>

		<p class="desc">

			Les données stockées ne constituent que la base des animations - la lecture réelle est contrôlée par
			l'`AnimationMixer`. Vous pouvez imaginer cela non seulement comme un lecteur d'animations, mais
			comme une simulation d'un matériel similaire à une véritable console de mixage, qui peut contrôler plusieurs animations
			simultanément, les mélangeant et les fusionnant.

		</p>

		<h3>Actions d'animation</h3>

		<p class="desc">

			L'`AnimationMixer` lui-même ne possède que très peu de propriétés et de méthodes (générales), car il
			peut être contrôlé par les actions d'animation. En configurant un
			`AnimationAction`, vous pouvez déterminer quand un certain `AnimationClip` doit être joué, mis en pause
			ou arrêté sur l'un des mixeurs, si et combien de fois le clip doit être répété, s'il
			doit être exécuté avec un fondu ou une mise à l'échelle temporelle, et quelques éléments supplémentaires, tels que le crossfading
			ou la synchronisation.

		</p>

		<h3>Groupes d'objets d'animation</h3>

		<p class="desc">

			Si vous souhaitez qu'un groupe d'objets reçoive un état d'animation partagé, vous pouvez utiliser un
			`AnimationObjectGroup`.

		</p>

		<h3>Formats et chargeurs pris en charge</h3>

		<p class="desc">
			Notez que tous les formats de modèle n'incluent pas l'animation (OBJ notamment ne l'inclut pas), et que seuls certains
			chargeurs three.js prennent en charge les séquences `AnimationClip`. Plusieurs qui le prennent en charge
			ce type d'animation sont :
		</p>

			<ul>
				<li>THREE.ObjectLoader</li>
				<li>THREE.BVHLoader</li>
				<li>THREE.ColladaLoader</li>
				<li>THREE.FBXLoader</li>
				<li>THREE.GLTFLoader</li>
			</ul>

		<p class="desc">
			Notez que 3ds max et Maya ne peuvent actuellement pas exporter plusieurs animations (c'est-à-dire des animations qui ne sont pas
			sur la même ligne de temps) directement dans un seul fichier.
		</p>

		<h2>Exemple</h2>

<pre class="prettyprint notranslate lang-js" translate="no">
let mesh;

// Créer un AnimationMixer et obtenir la liste des instances d'AnimationClip
const mixer = new THREE.AnimationMixer( mesh );
const clips = mesh.animations;

// Mettre à jour le mixeur à chaque image
function update () {
  mixer.update( deltaSeconds );
}

// Jouer une animation spécifique
const clip = THREE.AnimationClip.findByName( clips, 'dance' );
const action = mixer.clipAction( clip );
action.play();

// Jouer toutes les animations
clips.forEach( function ( clip ) {
  mixer.clipAction( clip ).play();
} );
</pre>

        </div>
      </div>
    </div>

  <script src="../resources/prettify.js"></script>
  <script src="../resources/lesson.js"></script>




</body></html>