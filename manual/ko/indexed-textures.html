<!DOCTYPE html><html lang="ko"><head>
    <meta charset="utf-8">
    <title>í”¼í‚¹ê³¼ ìƒ‰ìƒì— ì¸ë±ìŠ¤ í…ìŠ¤ì²˜ ì‚¬ìš©í•˜ê¸°</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@threejs">
    <meta name="twitter:title" content="Three.js â€“ í”¼í‚¹ê³¼ ìƒ‰ìƒì— ì¸ë±ìŠ¤ í…ìŠ¤ì²˜ ì‚¬ìš©í•˜ê¸°">
    <meta property="og:image" content="https://threejs.org/files/share.png">
    <link rel="shortcut icon" href="../../files/favicon_white.ico" media="(prefers-color-scheme: dark)">
    <link rel="shortcut icon" href="../../files/favicon.ico" media="(prefers-color-scheme: light)">

    <link rel="stylesheet" href="../resources/lesson.css">
    <link rel="stylesheet" href="../resources/lang.css">
<!-- Import maps polyfill -->
<!-- Remove this when import maps will be widely supported -->
<script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

<script type="importmap">
{
  "imports": {
    "three": "../../build/three.module.js"
  }
}
</script>
    <link rel="stylesheet" href="/manual/ko/lang.css">
  </head>
  <body>
    <div class="container">
      <div class="lesson-title">
        <h1>í”¼í‚¹ê³¼ ìƒ‰ìƒì— ì¸ë±ìŠ¤ í…ìŠ¤ì²˜ ì‚¬ìš©í•˜ê¸°</h1>
      </div>
      <div class="lesson">
        <div class="lesson-main">
          <p>â€» ì´ ê¸€ì€ <a href="align-html-elements-to-3d.html">HTML ìš”ì†Œë¥¼ 3Dë¡œ ì •ë ¬í•˜ê¸°</a>ì—ì„œ ì´ì–´ì§‘ë‹ˆë‹¤. ì´ì „ ê¸€ì„ ì½ì§€ ì•Šì•˜ë‹¤ë©´ ë¨¼ì € ì½ê³  ì˜¤ê¸° ë°”ëë‹ˆë‹¤.</p>
<p>Three.jsë¥¼ ì“°ë‹¤ë³´ë©´ ì°½ì˜ì ì¸ í•´ê²°ë²•ì´ í•„ìš”í•  ë•Œê°€ ìˆìŠµë‹ˆë‹¤. ì €ë„ ë‚˜ë¦„ ì‹œë¦¬ì¦ˆë¥¼ ì§„í–‰í•˜ë©° ë‚˜ë¦„ ë§ì€ í•´ê²°ë²•ì„ ì°¾ê³ , ì ì–´ ë†“ì•˜ì£ . í˜¹ í•„ìš”í•œ ê²Œ ìˆë‹¤ë©´ í™•ì¸í•´ë³´ê¸° ë°”ëë‹ˆë‹¤. ë¬¼ë¡  ê·¸ê²Œ ìµœì ì˜ í•´ê²°ë²•ì´ë¼ê³  ë‹¨ì–¸í•  ìˆ˜ëŠ” ì—†ì§€ë§Œìš”.</p>
<p><a href="align-html-elements-to-3d.html">ì´ì „ ê¸€</a>ì—ì„œëŠ” 3D ì§€êµ¬ë³¸ ì£¼ìœ„ì— ë‚˜ë¼ ì´ë¦„ì„ í‘œê¸°í–ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ë” ë‚˜ì•„ê°€ ì‚¬ìš©ìê°€ ë‚˜ë¼ë¥¼ ì„ íƒí•˜ê³  ìê¸°ê°€ ì„ íƒí•œ ë‚˜ë¼ë¥¼ ë³´ê²Œ í•œë‹¤ë©´ ì–´ë–¨ê¹Œìš”? ë˜ ì–´ë–»ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>
<p>ê°€ì¥ ì‰½ê²Œ ë– ì˜¤ë¥´ëŠ” ë°©ë²•ì€ ê° ë‚˜ë¼ë§ˆë‹¤ geometryë¥¼ ë§Œë“œëŠ” ê²ë‹ˆë‹¤. ì´ì „ì— í–ˆë˜ ê²ƒì²˜ëŸ¼ <a href="picking.html">í”¼í‚¹(picking)</a>ì„ ì¨ì„œ êµ¬í˜„í•  ìˆ˜ ìˆê² ì£ . ì´ë¯¸ ê° ë‚˜ë¼ì˜ 3D geometryëŠ” ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì‚¬ìš©ìê°€ meshë¥¼ í´ë¦­í–ˆì„ ë•Œ ì–´ë–¤ ë‚˜ë¼ë¥¼ í´ë¦­í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>
<p>ì‹œí—˜ì‚¼ì•„ <a href="align-html-elements-to-3d.html">ì´ì „ ê¸€</a>ì—ì„œ ìœ¤ê³½ì„ ì„ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©í–ˆë˜ ë°ì´í„°ë¡œ ê° ë‚˜ë¼ë§ˆë‹¤ 3D meshë¥¼ ë§Œë“¤ì–´ë´¤ìŠµë‹ˆë‹¤. ê²°ê³¼ë¡œ 15.5MBì§œë¦¬ GLTF(.glb) íŒŒì¼ì´ ë‚˜ì™”ì£ . ì‚¬ìš©ìê°€ ê°„ë‹¨í•œ ì§€êµ¬ë³¸ì„ ë³´ë ¤ê³  15.5MBë‚˜ ë‹¤ìš´ ë°›ì•„ì•¼ í•œë‹¤ë‹ˆ, ê°œì¸ì ì¸ ì˜ê²¬ì´ì§€ë§Œ ë„ˆë¬´ ê³¼í•œ ë“¯í•©ë‹ˆë‹¤.</p>
<p>ë°ì´í„°ë¥¼ ì••ì¶•í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ì•¼ ë§ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • ì•Œê³ ë¦¬ì¦˜ì„ ë„ì…í•´ ìœ¤ê³½ì„ ì˜ í•´ìƒë„ë¥¼ ë‚®ì¶œ ìˆ˜ ìˆì£ . ì´ ê¸€ì—ì„œëŠ” ì‹œë„í•˜ì§€ ì•Šì„ í…ë°, ì´ìœ ëŠ” ë¯¸êµ­ì˜ ê²½ìš° ë°ì´í„°ë¥¼ ë§ì´ ì¤„ì¼ ìˆ˜ ìˆê² ì§€ë§Œ ìºë‚˜ë‹¤ë‚˜ ì„¬ì´ ë§ì€ ë‚˜ë¼ëŠ” ê·¸ë ‡ì§€ ì•Šì„ ê²ƒì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ë‹¤ë¥¸ ë°©ë²•ì€ ì‹¤ì œ ë°ì´í„°ë¥¼ ì „ë¶€ ì••ì¶•í•˜ëŠ” ê²ë‹ˆë‹¤. ì••ì¶• í”„ë¡œê·¸ë¨ì„ ëŒë ¤ ì••ì¶•í•˜ë‹ˆ ìš©ëŸ‰ì´ 11MBê¹Œì§€ ì¤„ë”êµ°ìš”. 30% ì •ë„ ì¤„ê¸´ í–ˆì§€ë§Œ ì—¬ì „íˆ í° íŒŒì¼ì…ë‹ˆë‹¤.</p>
<p>32ë¹„íŠ¸ ë¶€ë™ ì†Œìˆ˜ ëŒ€ì‹  16ë¹„íŠ¸ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë˜ëŠ” <a href="https://google.github.io/draco/">ë“œë ˆì´ì½” ì••ì¶•ê¸°</a> ê°™ì€ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„íˆ ë°ì´í„°ë¥¼ ì¤„ì¼ ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¥´ì£ . ì „ ë”°ë¡œ ë“œë ˆì´ì½” ì••ì¶•ê¸°ë¥¼ ì‚¬ìš©í•´ë³´ì§„ ì•Šì•˜ìœ¼ë‹ˆ ì—¬ëŸ¬ë¶„ì´ í•œ ë²ˆ ì¨ë³´ì‹œê³  ì•Œë ¤ì£¼ì‹ ë‹¤ë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤ ğŸ˜….</p>
<p>ì´ ê¸€ì—ì„œëŠ” <a href="picking.html">í”¼í‚¹ì— ê´€í•œ ê¸€</a> ë§ˆì§€ë§‰ì—ì„œ ë‹¤ë¤˜ë˜ <a href="picking.html">GPU í”¼í‚¹</a>ì„ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤. ê° meshì— id ì—­í• ì„ í•  ê³ ìœ í•œ ìƒ‰ì„ ë¶€ì—¬í•˜ê³  í•´ë‹¹ meshë¥¼ í´ë¦­í–ˆì„ ë•Œ í•´ë‹¹ í”½ì…€ì˜ ìƒ‰ìƒê°’ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì–´ë–¤ meshë¥¼ í´ë¦­í–ˆëŠ”ì§€ ì•Œì•„ë‚´ëŠ” ë°©ë²•ì´ì£ .</p>
<p>ì¼ë‹¨ ê° ë‚˜ë¼ì— ê³ ìœ í•œ ìƒ‰ìƒì„ ë¶€ì—¬í•œ ë’¤, ì´ ìƒ‰ìƒê°’ì„ ì¸ë±ìŠ¤ë¡œ ë‚˜ë¼ ë°°ì—´ì„ ë§Œë“­ë‹ˆë‹¤. ê·¸ë¦¬ê³  í”¼í‚¹ìš© í…ìŠ¤ì²˜ë¥¼ ë§Œë“  ë’¤ ì´ê±¸ë¡œ ì§€êµ¬ë³¸ì„ ë Œë”ë§í•©ë‹ˆë‹¤. ì´ëŸ¬ë©´ ì‚¬ìš©ìê°€ í´ë¦­í•œ í”½ì…€ì„ í™•ì¸í•´ ì–´ë–¤ ë‚˜ë¼ë¥¼ í´ë¦­í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆê² ì£ .</p>
<p>ë¨¼ì € <a href="https://github.com/mrdoob/three.js/blob/master/manual/resources/tools/geo-picking/">ì•½ê°„ì˜ ì½”ë“œ</a>ë¥¼ ì‘ì„±í•´ ì•„ë˜ì˜ í…ìŠ¤ì²˜ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p>
<div class="threejs_center"><img src="../examples/resources/data/world/country-index-texture.png" style="width: 700px;"></div>

<blockquote>
<p>ì°¸ê³ : ì´ í…ìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” ë° ì‚¬ìš©í•œ ë°ì´í„°ëŠ” ì´ <a href="http://thematicmapping.org/downloads/world_borders.php">ì›¹ì‚¬ì´íŠ¸</a>ì´ë©°, ë¼ì´ì„ ìŠ¤ëŠ” <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>ì…ë‹ˆë‹¤.</p>
</blockquote>
<p>ì´ ì´ë¯¸ì§€ëŠ” 271KB ì •ë„ë°–ì— ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‚˜ë¼ë“¤ì˜ meshê°€ 14MBê°€ ë„˜ì—ˆë˜ ê²ƒì— ë¹„í•˜ë©´ í›¨ì”¬ ë‚«ë„¤ìš”. ë¬¼ë¡  í•´ìƒë„ë¥¼ ë” ë‚®ì¶œ ìˆ˜ë„ ìˆì§€ë§Œ ì´ ì •ë„ë©´ ì¶©ë¶„í•œ ê²ƒ ê°™ë„¤ìš”.</p>
<p>ì´ì œ ë‚˜ë¼ì— í”¼í‚¹ì„ ì ìš©í•´ ë´…ì‹œë‹¤.</p>
<p><a href="picking.html">GPU í”¼í‚¹ ì˜ˆì œ</a>ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì™€ í”¼í‚¹ìš© ì¥ë©´(scene)ì„ ë”°ë¡œ ë§Œë“­ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const pickingScene = new THREE.Scene();
pickingScene.background = new THREE.Color(0);
</pre>
<p>í”¼í‚¹ìš© ì¥ë©´ì— í”¼í‚¹ìš© í…ìŠ¤ì²˜ë¥¼ ì…íŒ ì§€êµ¬ë³¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">{
  const loader = new THREE.TextureLoader();
  const geometry = new THREE.SphereGeometry(1, 64, 32);

+  const indexTexture = loader.load('resources/data/world/country-index-texture.png', render);
+  indexTexture.minFilter = THREE.NearestFilter;
+  indexTexture.magFilter = THREE.NearestFilter;
+
+  const pickingMaterial = new THREE.MeshBasicMaterial({ map: indexTexture });
+  pickingScene.add(new THREE.Mesh(geometry, pickingMaterial));

  const texture = loader.load('resources/data/world/country-outlines-4k.png', render);
  const material = new THREE.MeshBasicMaterial({ map: texture });
  scene.add(new THREE.Mesh(geometry, material));
}
</pre>
<p>ë‹¤ìŒìœ¼ë¡œ <code class="notranslate" translate="no">GPUPickHelper</code>ë¥¼ í†µì§¸ë¡œ ê°€ì ¸ì™€ ëª‡ ê°€ì§€ ìˆ˜ì •í•©ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">class GPUPickHelper {
  constructor() {
    // 1x1 í”½ì…€ í¬ê¸°ì˜ ë Œë” íƒ€ê²Ÿì„ ìƒì„±í•©ë‹ˆë‹¤
    this.pickingTexture = new THREE.WebGLRenderTarget(1, 1);
    this.pixelBuffer = new Uint8Array(4);
-    this.pickedObject = null;
-    this.pickedObjectSavedColor = 0;
  }
  pick(cssPosition, scene, camera) {
    const { pickingTexture, pixelBuffer } = this;

    // view offsetì„ ë§ˆìš°ìŠ¤ í¬ì¸í„° ì•„ë˜ 1í”½ì…€ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
    const pixelRatio = renderer.getPixelRatio();
    camera.setViewOffset(
      renderer.getContext().drawingBufferWidth,   // ì „ì²´ ë„ˆë¹„
      renderer.getContext().drawingBufferHeight,  // ì „ì²´ ë†’ì´
      cssPosition.x * pixelRatio | 0,             // ì‚¬ê° x ì¢Œí‘œ
      cssPosition.y * pixelRatio | 0,             // ì‚¬ê° y ì¢Œí‘œ
      1,                                          // ì‚¬ê° ì¢Œí‘œ width
      1,                                          // ì‚¬ê° ì¢Œí‘œ height
    );
    // ì¥ë©´ì„ ë Œë”ë§í•©ë‹ˆë‹¤
    renderer.setRenderTarget(pickingTexture);
    renderer.render(scene, camera);
    renderer.setRenderTarget(null);
    // view offsetì„ ì •ìƒìœ¼ë¡œ ëŒë ¤ ì›ë˜ì˜ í™”ë©´ì„ ë Œë”ë§í•˜ë„ë¡ í•©ë‹ˆë‹¤
    camera.clearViewOffset();
    // í”½ì…€ì„ ê°ì§€í•©ë‹ˆë‹¤
    renderer.readRenderTargetPixels(
        pickingTexture,
        0,   // x
        0,   // y
        1,   // width
        1,   // height
        pixelBuffer);

+    const id =
+        (pixelBuffer[0] &lt;&lt; 16) |
+        (pixelBuffer[1] &lt;&lt;  8) |
+        (pixelBuffer[2] &lt;&lt;  0);
+
+    return id;
-    const id =
-        (pixelBuffer[0] &lt;&lt; 16) |
-        (pixelBuffer[1] &lt;&lt;  8) |
-        (pixelBuffer[2]      );
-    const intersectedObject = idToObject[id];
-    if (intersectedObject) {
-      // ì²« ë²ˆì§¸ ë¬¼ì²´ê°€ ì œì¼ ê°€ê¹Œìš°ë¯€ë¡œ í•´ë‹¹ ë¬¼ì²´ë¥¼ ê³ ë¦…ë‹ˆë‹¤
-      this.pickedObject = intersectedObject;
-      // ê¸°ì¡´ ìƒ‰ì„ ì €ì¥í•´ë‘¡ë‹ˆë‹¤
-      this.pickedObjectSavedColor = this.pickedObject.material.emissive.getHex();
-      // emissive ìƒ‰ì„ ë¹¨ê°•/ë…¸ë‘ìœ¼ë¡œ ë¹›ë‚˜ê²Œ ë§Œë“­ë‹ˆë‹¤
-      this.pickedObject.material.emissive.setHex((time * 8) % 2 &gt; 1 ? 0xFFFF00 : 0xFF0000);
-    }
  }
}
</pre>
<p><code class="notranslate" translate="no">GPUPickHelper</code>ë¥¼ ì´ìš©í•´ ë‚˜ë¼ë¥¼ ì„ íƒí•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const pickHelper = new GPUPickHelper();

function getCanvasRelativePosition(event) {
  const rect = canvas.getBoundingClientRect();
  return {
    x: (event.clientX - rect.left) * canvas.width  / rect.width,
    y: (event.clientY - rect.top ) * canvas.height / rect.height,
  };
}

function pickCountry(event) {
  // ì•„ì§ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•˜ì„ ê²½ìš°
  if (!countryInfos) {
    return;
  }

  const position = getCanvasRelativePosition(event);
  const id = pickHelper.pick(position, pickingScene, camera);
  if (id &gt; 0) {
    // ë‚˜ë¼ë¥¼ ì„ íƒí–ˆì„ ë•Œ í•´ë‹¹ ë‚˜ë¼ì˜ 'selected' ì†ì„±ì„ ë°”ê¿‰ë‹ˆë‹¤.
    const countryInfo = countryInfos[id - 1];
    const selected = !countryInfo.selected;
    // ë‚˜ë¼ë¥¼ í´ë¦­í–ˆì„ ë•Œ íŠ¹ìˆ˜í‚¤ë¥¼ ëˆ„ë¥´ì§€ ì•Šì•˜ë‹¤ë©´ ë‹¤ë¥¸ ë‚˜ë¼ì˜ 'selected'
    // ì†ì„±ì„ ì „ë¶€ ë•ë‹ˆë‹¤.
    if (selected &amp;&amp; !event.shiftKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.metaKey) {
      unselectAllCountries();
    }
    numCountriesSelected += selected ? 1 : -1;
    countryInfo.selected = selected;
  } else if (numCountriesSelected) {
    // ë°”ë‹¤ë‚˜ í•˜ëŠ˜ì„ í´ë¦­í–ˆì„ ê²½ìš°
    unselectAllCountries();
  }
  requestRenderIfNotRequested();
}

function unselectAllCountries() {
  numCountriesSelected = 0;
  countryInfos.forEach((countryInfo) =&gt; {
    countryInfo.selected = false;
  });
}

canvas.addEventListener('pointerup', pickCountry);
</pre>
<p>ìœ„ ì½”ë“œëŠ” ë‚˜ë¼ ë°°ì—´ì— ì†í•œ ë‚˜ë¼ì˜ <code class="notranslate" translate="no">selected</code> ì†ì„±ì„ ì¼œê³  ë•ë‹ˆë‹¤. <code class="notranslate" translate="no">shift</code>, <code class="notranslate" translate="no">ctrl</code>, <code class="notranslate" translate="no">cmd</code> ì¤‘ í•˜ë‚˜ë¥¼ ëˆ„ë¥´ë©´ í•˜ë‚˜ ì´ìƒì˜ ë‚˜ë¼ë¥¼ ì„ íƒí•  ìˆ˜ ìˆì£ .</p>
<p>ì´ì œ ì„ íƒí•œ ë‚˜ë¼ë¥¼ ë³´ì—¬ì¤„ ì¼ë§Œ ë‚¨ì•˜ìŠµë‹ˆë‹¤. ì§€ê¸ˆì€ ì¼ë‹¨ í•´ë‹¹ ë‚˜ë¼ì˜ ì´ë¦„í‘œë¥¼ ë³´ì—¬ì£¼ê¸°ë¡œ í•˜ì£ .</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">function updateLabels() {
  // ì•„ì§ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•˜ì„ ê²½ìš°
  if (!countryInfos) {
    return;
  }

  const large = settings.minArea * settings.minArea;
  // ì¹´ë©”ë¼ì˜ ìƒëŒ€ ë°©í–¥ì„ ë‚˜íƒ€ë‚´ëŠ” í–‰ë ¬ ì¢Œí‘œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
  normalMatrix.getNormalMatrix(camera.matrixWorldInverse);
  // ì¹´ë©”ë¼ì˜ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
  camera.getWorldPosition(cameraPosition);
  for (const countryInfo of countryInfos) {
-    const { position, elem, area } = countryInfo;
-    // ì˜ì—­ì´ íŠ¹ì • ê°’ë³´ë‹¤ ì‘ë‹¤ë©´ ì´ë¦„í‘œë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
-    if (area &lt; large) {
+    const { position, elem, area, selected } = countryInfo;
+    const largeEnough = area &gt;= large;
+    const show = selected || (numCountriesSelected === 0 &amp;&amp; largeEnough);
+    if (!show) {
      elem.style.display = 'none';
      continue;
    }

    ...
</pre>
<p>ì´ì œ ë‚˜ë¼ë¥¼ ì„ íƒí•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p></p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/manual/examples/resources/editor.html?url=/manual/examples/indexed-textures-picking.html"></iframe></div>
  <a class="threejs_center" href="/manual/examples/indexed-textures-picking.html" target="_blank">ìƒˆ íƒ­ì—ì„œ ë³´ê¸°</a>
</div>

<p></p>
<p>ìœ„ ì˜ˆì œëŠ” ì—¬ì „íˆ ì˜ì—­ í¬ê¸°ì— ë”°ë¼ ë‚˜ë¼ ì´ë¦„ì„ ë³´ì—¬ì£¼ê¸´ í•˜ë‚˜, íŠ¹ì • ë‚˜ë¼ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ë‚˜ë¼ì˜ ì´ë¦„ë§Œ ë³´ì—¬ì¤„ ê²ë‹ˆë‹¤.</p>
<p>ì´ë§Œí•˜ë©´ ê° ë‚˜ë¼ë¥¼ í”¼í‚¹í•˜ëŠ” ì˜ˆì œë¡œ ì¶©ë¶„í•´ ë³´ì´ì§€ë§Œ... ì„ íƒí•œ ë‚˜ë¼ì˜ ìƒ‰ì„ ë°”ê¾¸ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?</p>
<p><em>ì»¬ëŸ¬ íŒ”ë ˆíŠ¸(color palette)</em>ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><a href="https://ko.wikipedia.org/wiki/%ED%8C%94%EB%A0%88%ED%8A%B8_(%EC%BB%B4%ED%93%A8%ED%8C%85">ì»¬ëŸ¬ íŒ”ë ˆíŠ¸</a>) í˜¹ì€ <a href="https://en.wikipedia.org/wiki/Indexed_color">ì¸ë±ìŠ¤ íŒ”ë ˆíŠ¸</a>ëŠ” ì•„íƒ€ë¦¬ 800, Amiga, NES, ìŠˆí¼ ë‹Œí…ë„, êµ¬í˜• IBM PC ë“± êµ¬í˜• ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ë˜ ê¸°ë²•ì…ë‹ˆë‹¤. ë¹„íŠ¸ë§µì„ ìƒ‰ìƒë‹¹ 8ë¹„íŠ¸ í˜¹ì€ 32ë°”ì´íŠ¸ ì´ìƒì˜ RGBA ìƒ‰ìƒìœ¼ë¡œ ì ìš©í•˜ëŠ” ëŒ€ì‹  ë¹„íŠ¸ë§µì„ 8ë¹„íŠ¸ ì´í•˜ì˜ ê°’ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ê¸°ë²•ì´ì£ . ê° í”½ì…€ì˜ ìƒ‰ìƒê°’ì€ íŒ”ë ˆíŠ¸ì˜ ì¸ë±ìŠ¤ ê°’ìœ¼ë¡œ, í”½ì…€ì˜ ìƒ‰ìƒê°’ì´ 3ì´ë¼ë©´ íŠ¹ì • "íŒ”ë ˆíŠ¸"ì˜ 3ë²ˆ ìƒ‰ìƒì„ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>
<p>ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì„¤ëª…í•˜ìë©´ ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ì„ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const face7x7PixelImageData = [
  0, 1, 1, 1, 1, 1, 0,
  1, 0, 0, 0, 0, 0, 1,
  1, 0, 2, 0, 2, 0, 1,
  1, 0, 0, 0, 0, 0, 1,
  1, 0, 3, 3, 3, 0, 1,
  1, 0, 0, 0, 0, 0, 1,
  0, 1, 1, 1, 1, 1, 1,
];

const palette = [
  [255, 255, 255],  // white
  [  0,   0,   0],  // black
  [  0, 255, 255],  // cyan
  [255,   0,   0],  // red
];
</pre>
<p>ì´ë¯¸ì§€ ë°ì´í„°ì˜ ê° í”½ì…€ì€ íŒ”ë ˆíŠ¸ì˜ ì¸ë±ìŠ¤ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤. ìœ„ ë°ì´í„°ë¥¼ ìœ„ íŒ”ë ˆíŠ¸ë¡œ í•´ì„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì´ë¯¸ì§€ê°€ ë‚˜ì˜¤ê² ì£ .</p>
<div class="threejs_center"><img src="../resources/images/7x7-indexed-face.png"></div>

<p>ì˜ˆì œì˜ ê²½ìš° ì´ë¯¸ ê° ë‚˜ë¼ë³„ë¡œ ê³ ìœ  ìƒ‰ì„ ë¶€ì—¬í•œ í…ìŠ¤ì²˜ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í…ìŠ¤ì²˜ì— íŒ”ë ˆíŠ¸ë¥¼ ì ìš©í•˜ë©´ ê° ë‚˜ë¼ì— ë‹¤ë¥¸ ìƒ‰ì„ ë¶€ì—¬í•  ìˆ˜ ìˆê² ì£ . ë˜ ì´ íŒ”ë ˆíŠ¸ì˜ ìƒ‰ì„ ë°”ê¾¸ë©´ ê° ë‚˜ë¼ì˜ ìƒ‰ë„ ë°”ë€” ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë‹ˆ íŒ”ë ˆíŠ¸ì˜ ìƒ‰ì„ ì „ë¶€ ê²€ì •ìœ¼ë¡œ ë°”ê¾¼ ë’¤, ì„ íƒí•œ ë‚˜ë¼ë§Œ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ ë°”ê¾¸ë©´ í•´ë‹¹ ë‚˜ë¼ë¥¼ ì„ íƒí–ˆë‹¤ëŠ” ê²ƒì„ ì‹œê°ì ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>
<p>ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ ê¸°ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì‰ì´ë”ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. Three.jsì˜ ë‚´ì¥ ì‰ì´ë”ë¥¼ ìˆ˜ì •í•´ì„œ ì‚¬ìš©í•˜ë©´ ì¡°ëª…ì´ë‚˜ ë‹¤ë¥¸ ê¸°ëŠ¥ë„ ë‚˜ì¤‘ì— ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ì£ .</p>
<p><a href="optimize-lots-of-objects-animated.html">ë‹¤ì¤‘ ì• ë‹ˆë©”ì´ì…˜ ìš”ì†Œ ìµœì í™”í•˜ê¸°</a>ì—ì„œ ë‹¤ë¤˜ë“¯ ì¬ì§ˆì˜ <code class="notranslate" translate="no">onBeforeCompile</code> ì†ì„±ì— í•¨ìˆ˜ë¥¼ ì§€ì •í•˜ë©´ ë‚´ì¥ ì‰ì´ë”ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ëŠ” ë‚´ì¥ fragment ì‰ì´ë”ë¥¼ ìˆ˜ì •í•˜ê¸° ì „ì…ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-glsl" translate="no">#include &lt;common&gt;
#include &lt;color_pars_fragment&gt;
#include &lt;uv_pars_fragment&gt;
#include &lt;map_pars_fragment&gt;
#include &lt;alphamap_pars_fragment&gt;
#include &lt;aomap_pars_fragment&gt;
#include &lt;lightmap_pars_fragment&gt;
#include &lt;envmap_pars_fragment&gt;
#include &lt;fog_pars_fragment&gt;
#include &lt;specularmap_pars_fragment&gt;
#include &lt;logdepthbuf_pars_fragment&gt;
#include &lt;clipping_planes_pars_fragment&gt;
void main() {
    #include &lt;clipping_planes_fragment&gt;
    vec4 diffuseColor = vec4( diffuse, opacity );
    #include &lt;logdepthbuf_fragment&gt;
    #include &lt;map_fragment&gt;
    #include &lt;color_fragment&gt;
    #include &lt;alphamap_fragment&gt;
    #include &lt;alphatest_fragment&gt;
    #include &lt;specularmap_fragment&gt;
    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
    #ifdef USE_LIGHTMAP
        reflectedLight.indirectDiffuse += texture2D( lightMap, vLightMapUv ).xyz * lightMapIntensity;
    #else
        reflectedLight.indirectDiffuse += vec3( 1.0 );
    #endif
    #include &lt;aomap_fragment&gt;
    reflectedLight.indirectDiffuse *= diffuseColor.rgb;
    vec3 outgoingLight = reflectedLight.indirectDiffuse;
    #include &lt;envmap_fragment&gt;
    gl_FragColor = vec4( outgoingLight, diffuseColor.a );
    #include &lt;premultiplied_alpha_fragment&gt;
    #include &lt;tonemapping_fragment&gt;
    #include &lt;colorspace_fragment&gt;
    #include &lt;fog_fragment&gt;
}
</pre>
<p><a href="https://github.com/mrdoob/three.js/tree/dev/src/renderers/shaders/ShaderChunk">ìœ„ ì½”ë“œì˜ ì‰ì´ë” ì¡°ê°</a>ì„ ì¼ì¼ì´ ë’¤ì ¸ ë³´ë‹ˆ Three.jsëŠ” <code class="notranslate" translate="no">diffuseColor</code>ë¼ëŠ” ë³€ìˆ˜ë¡œ ì¬ì§ˆ(material)ì˜ ìƒ‰ìƒê°’ì„ ì œì–´í•©ë‹ˆë‹¤. ì´ ë³€ìˆ˜ëŠ” <code class="notranslate" translate="no">&lt;color_fragment&gt;</code>ë¼ëŠ” <a href="https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/color_fragment.glsl.js">ì‰ì´ë” ì¡°ê°</a>ì—ì„œ ì„ ì–¸í•˜ë‹ˆ ë³€ìˆ˜ ì„ ì–¸ í›„ì— ìƒ‰ìƒê°’ì„ ìˆ˜ì •í•˜ë©´ ë˜ê² ë„¤ìš”.</p>
<p>ì € ë•Œ <code class="notranslate" translate="no">diffuseColor</code>ëŠ” ì•„ê¹Œ ë§Œë“¤ì—ˆë˜ ìœ¤ê³½ì„  í…ìŠ¤ì²˜ì—ì„œ ìƒ‰ìƒì„ ê°€ì ¸ì˜¨ ìƒíƒœì¼ í…Œë‹ˆ, ì´ ìƒ‰ìƒê°’ìœ¼ë¡œ íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ì—ì„œ ìƒˆë¡œìš´ ìƒ‰ìƒê°’ì„ ê°€ì ¸ ì˜¬ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>
<p><a href="optimize-lots-of-objects-animated.html">ì´ì „ì— í–ˆë˜ ê²ƒ</a>ì²˜ëŸ¼ ë°”ê¿€ ë¬¸ìì—´ ì •ë³´ë¥¼ ë°°ì—´ë¡œ ë§Œë“¤ì–´ <a href="/docs/#api/ko/materials/Material.onBeforeCompile"><code class="notranslate" translate="no">Material.onBeforeCompile</code></a>ì—ì„œ ì‰ì´ë”ë¥¼ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">{
  const loader = new THREE.TextureLoader();
  const geometry = new THREE.SphereGeometry(1, 64, 32);

  const indexTexture = loader.load('resources/data/world/country-index-texture.png', render);
  indexTexture.minFilter = THREE.NearestFilter;
  indexTexture.magFilter = THREE.NearestFilter;

  const pickingMaterial = new THREE.MeshBasicMaterial({ map: indexTexture });
  pickingScene.add(new THREE.Mesh(geometry, pickingMaterial));

+  const fragmentShaderReplacements = [
+    {
+      from: '#include &lt;common&gt;',
+      to: `
+        #include &lt;common&gt;
+        uniform sampler2D indexTexture;
+        uniform sampler2D paletteTexture;
+        uniform float paletteTextureWidth;
+      `,
+    },
+    {
+      from: '#include &lt;color_fragment&gt;',
+      to: `
+        #include &lt;color_fragment&gt;
+        {
+          vec4 indexColor = texture2D(indexTexture, vUv);
+          float index = indexColor.r * 255.0 + indexColor.g * 255.0 * 256.0;
+          vec2 paletteUV = vec2((index + 0.5) / paletteTextureWidth, 0.5);
+          vec4 paletteColor = texture2D(paletteTexture, paletteUV);
+          // diffuseColor.rgb += paletteColor.rgb;   // í•˜ì–€ ìœ¤ê³½ì„ 
+          diffuseColor.rgb = paletteColor.rgb - diffuseColor.rgb;  // ê²€ì€ ìœ¤ê³½ì„ 
+        }
+      `,
+    },
+  ];

  const texture = loader.load('resources/data/world/country-outlines-4k.png', render);
  const material = new THREE.MeshBasicMaterial({ map: texture });
+  material.onBeforeCompile = function(shader) {
+    fragmentShaderReplacements.forEach((rep) =&gt; {
+      shader.fragmentShader = shader.fragmentShader.replace(rep.from, rep.to);
+    });
+  };
  scene.add(new THREE.Mesh(geometry, material));
}
</pre>
<p>ìœ„ ì½”ë“œì—ì„œëŠ” <code class="notranslate" translate="no">indexTexture</code>, <code class="notranslate" translate="no">paletteTexture</code>, <code class="notranslate" translate="no">paletteTextureWidth</code>, ì´ 3ê°œì˜ ê· ë“± ë³€ìˆ˜(uniform)ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. <code class="notranslate" translate="no">indexTexture</code>ëŠ” ìƒ‰ìƒê°’ì„ ë¶ˆëŸ¬ì™€ ì¸ë±ìŠ¤ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•œ ê²ƒìœ¼ë¡œ, ì´ë•Œ ì‚¬ìš©í•œ <code class="notranslate" translate="no">vUv</code>ëŠ” Three.jsê°€ ë„˜ê²¨ì£¼ëŠ” í…ìŠ¤ì²˜ ì¢Œí‘œì´ì£ . ê·¸ë¦¬ê³  ì´ ì¸ë±ìŠ¤ ê°’ìœ¼ë¡œ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ì—ì„œ ìƒˆë¡œìš´ ìƒ‰ìƒê°’ì„ ê°€ì ¸ ì™€ <code class="notranslate" translate="no">diffuseColor</code>ì™€ ì„ì—ˆìŠµë‹ˆë‹¤. ì´ë•Œ <code class="notranslate" translate="no">diffuseColor</code>ëŠ” ê²€ì€ë°”íƒ•ì— í•˜ì–€ìƒ‰ ìœ¤ê³½ì„  í…ìŠ¤ì²˜ì´ë‹ˆ ë‘ ìƒ‰ì„ ë”í•´ë„ í•˜ì–€ ìœ¤ê³½ì„ ì´ ë‚˜ì˜¬ ê²ë‹ˆë‹¤. ëŒ€ì‹  ìƒˆë¡œìš´ ìƒ‰ì—ì„œ <code class="notranslate" translate="no">diffuseColor</code>ë¥¼ ëº€ë‹¤ë©´ ê²€ì€ ìœ¤ê³½ì„ ì´ ë‚˜ì˜¤ê² ì£ .</p>
<p>ë‹¤ìŒìœ¼ë¡œ ë Œë”ë§ ì „ì— íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ì™€ 3ê°œì˜ ê· ë“± ë³€ìˆ˜ë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ì—ëŠ” ë‚˜ë¼ë‹¹ í•˜ë‚˜ì˜ ìƒ‰ìƒê³¼ ë°”ë‹¤ì˜ ìƒ‰ìƒ(id = 0) í•˜ë‚˜ë§Œ í•„ìš”í•©ë‹ˆë‹¤. ì „ ì„¸ê³„ì ìœ¼ë¡œ ì•½ 240ì—¬ ê°œì˜ ë‚˜ë¼ê°€ ìˆì£ . ë‚˜ë¼ ë°°ì—´ì„ ë¶ˆëŸ¬ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì •í™•í•œ ê°œìˆ˜ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ë„ ìˆì„ ê²ë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¹ì¥ ìˆ«ìê°€ í¬ë‹¤ê³  ë¬¸ì œê°€ ë  ê²ƒ ê°™ì§€ëŠ” ì•Šìœ¼ë‹ˆ 512 ì •ë„ì˜ í° ìˆ«ìë¥¼ ê³ ë¥´ê¸°ë¡œ í•©ì‹œë‹¤.</p>
<p>ì•„ë˜ëŠ” íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ë¥¼ ë§Œë“œëŠ” ì½”ë“œì…ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const maxNumCountries = 512;
const paletteTextureWidth = maxNumCountries;
const paletteTextureHeight = 1;
const palette = new Uint8Array(paletteTextureWidth * 4);
const paletteTexture = new THREE.DataTexture(
    palette, paletteTextureWidth, paletteTextureHeight);
paletteTexture.minFilter = THREE.NearestFilter;
paletteTexture.magFilter = THREE.NearestFilter;
</pre>
<p><a href="/docs/#api/ko/textures/DataTexture"><code class="notranslate" translate="no">DataTexture</code></a>ë¥¼ ì“°ë©´ í…ìŠ¤ì²˜ë¥¼ ë¡œìš°-ë°ì´í„°(raw data) í˜•ì‹ìœ¼ë¡œ ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì œì˜ ê²½ìš°ì—ëŠ” 512 RGBA ìƒ‰ìƒì„ ë„˜ê²¨ì£¼ë©´ ë˜ê² ì£ . ê° ê°’ì€ 3ë°”ì´íŠ¸ë¡œ, ì´ ë°”ì´íŠ¸ëŠ” ê°ê° red, green, blueì„ 0ë¶€í„° 255ê¹Œì§€ì˜ ìˆ«ìë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
<p>ì¼ë‹¨ì€ ë¬´ì‘ìœ„ë¡œ ìƒ‰ì„ ì§€ì •í•´ ì˜ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë´…ì‹œë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">for (let i = 1; i &lt; palette.length; ++i) {
  palette[i] = Math.random() * 256;
}
// ë°”ë‹¤ì˜ ìƒ‰ì„ ì§€ì •í•©ë‹ˆë‹¤. (index #0)
palette.set([100, 200, 255, 255], 0);
paletteTexture.needsUpdate = true;
</pre>
<p><code class="notranslate" translate="no">palette</code> ë°°ì—´ë¡œ íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œë§ˆë‹¤ ì¥ë©´ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ë‹ˆ <code class="notranslate" translate="no">paletteTexture.needsUpdate</code>ë¥¼ <code class="notranslate" translate="no">true</code>ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ ì¬ì§ˆì— ê· ë“± ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì¤ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const geometry = new THREE.SphereGeometry(1, 64, 32);
const material = new THREE.MeshBasicMaterial({ map: texture });
material.onBeforeCompile = function(shader) {
  fragmentShaderReplacements.forEach((rep) =&gt; {
    shader.fragmentShader = shader.fragmentShader.replace(rep.from, rep.to);
  });
+  shader.uniforms.paletteTexture = { value: paletteTexture };
+  shader.uniforms.indexTexture = { value: indexTexture };
+  shader.uniforms.paletteTextureWidth = { value: paletteTextureWidth };
};
scene.add(new THREE.Mesh(geometry, material));
</pre>
<p>ì´ì œ ì˜ˆì œë¥¼ ì‹¤í–‰í•˜ë©´ ê° ë‚˜ë¼ì˜ ìƒ‰ìƒì´ ë¬´ì‘ìœ„ë¡œ ì§€ì •ëœ ê²ƒì´ ë³´ì¼ ê²ë‹ˆë‹¤.</p>
<p></p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/manual/examples/resources/editor.html?url=/manual/examples/indexed-textures-random-colors.html"></iframe></div>
  <a class="threejs_center" href="/manual/examples/indexed-textures-random-colors.html" target="_blank">ìƒˆ íƒ­ì—ì„œ ë³´ê¸°</a>
</div>

<p></p>
<p>ì¸ë±ì‹±ê³¼ íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ê°€ ì˜ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í–ˆìœ¼ë‹ˆ, ì´ì œ íŒ”ë ˆíŠ¸ë¥¼ ì¡°ì‘í•´ ì„ íƒí•œ ë‚˜ë¼ì˜ ìƒ‰ìƒë§Œ ë°”ê¾¸ë„ë¡ í•´ë´…ì‹œë‹¤.</p>
<p>ë¨¼ì € í•¨ìˆ˜ë¥¼ í•˜ë‚˜ ë§Œë“­ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” Three.jsì˜ <a href="/docs/#api/ko/math/Color"><code class="notranslate" translate="no">Color</code></a>ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ íŒ”ë ˆíŠ¸ í…ìŠ¤ì²˜ì— ì§€ì •í•  ìˆ˜ ìˆëŠ” ê°’ì„ ë°˜í™˜í•  ê²ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const tempColor = new THREE.Color();
function get255BasedColor(color) {
  tempColor.set(color);
  const base = tempColor.toArray().map(v =&gt; v * 255);
  base.push(255); // alpha
  return base;
}
</pre>
<p>ìœ„ í•¨ìˆ˜ë¥¼ <code class="notranslate" translate="no">color = get255BasedColor('red')</code>ì™€ ê°™ì€ ì‹ìœ¼ë¡œ í˜¸ì¶œí•˜ë©´ <code class="notranslate" translate="no">[255, 0, 0]</code> ì´ëŸ° ì‹ì˜ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ ìœ„ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ëª‡ ê°€ì§€ ìƒ‰ì„ ë§Œë“¤ì–´ íŒ”ë ˆíŠ¸ë¥¼ ì±„ì›ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">const selectedColor = get255BasedColor('red');
const unselectedColor = get255BasedColor('#444');
const oceanColor = get255BasedColor('rgb(100,200,255)');
resetPalette();

function setPaletteColor(index, color) {
  palette.set(color, index * 4);
}

function resetPalette() {
  // ëª¨ë“  íŒ”ë ˆíŠ¸ì˜ ìƒ‰ìƒì„ unselectedColorë¡œ ë°”ê¿‰ë‹ˆë‹¤.
  for (let i = 1; i &lt; maxNumCountries; ++i) {
    setPaletteColor(i, unselectedColor);
  }

  // ë°”ë‹¤ì˜ ìƒ‰ì„ ì§€ì •í•©ë‹ˆë‹¤. (index #0)
  setPaletteColor(0, oceanColor);
  paletteTexture.needsUpdate = true;
}
</pre>
<p>ì´ì œ <code class="notranslate" translate="no">resetPalette</code> í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë‚˜ë¼ë¥¼ ì„ íƒí–ˆì„ ë•Œ íŒ”ë ˆíŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">function getCanvasRelativePosition(event) {
  const rect = canvas.getBoundingClientRect();
  return {
    x: (event.clientX - rect.left) * canvas.width  / rect.width,
    y: (event.clientY - rect.top ) * canvas.height / rect.height,
  };
}

function pickCountry(event) {
  // ì•„ì§ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•˜ì„ ê²½ìš°
  if (!countryInfos) {
    return;
  }

  const position = getCanvasRelativePosition(event);
  const id = pickHelper.pick(position, pickingScene, camera);
  if (id &gt; 0) {
    const countryInfo = countryInfos[id - 1];
    const selected = !countryInfo.selected;
    if (selected &amp;&amp; !event.shiftKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.metaKey) {
      unselectAllCountries();
    }
    numCountriesSelected += selected ? 1 : -1;
    countryInfo.selected = selected;
+    setPaletteColor(id, selected ? selectedColor : unselectedColor);
+    paletteTexture.needsUpdate = true;
  } else if (numCountriesSelected) {
    unselectAllCountries();
  }
  requestRenderIfNotRequested();
}

function unselectAllCountries() {
  numCountriesSelected = 0;
  countryInfos.forEach((countryInfo) =&gt; {
    countryInfo.selected = false;
  });
+  resetPalette();
}
</pre>
<p>ì´ì œ ì„ íƒí•œ ë‚˜ë¼ê°€ ê°•ì¡°ë˜ì–´ ë³´ì¼ ê²ë‹ˆë‹¤.</p>
<p></p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/manual/examples/resources/editor.html?url=/manual/examples/indexed-textures-picking-and-highlighting.html"></iframe></div>
  <a class="threejs_center" href="/manual/examples/indexed-textures-picking-and-highlighting.html" target="_blank">ìƒˆ íƒ­ì—ì„œ ë³´ê¸°</a>
</div>

<p></p>
<p>ì˜ ì‘ë™í•˜ëŠ” ê²ƒ ê°™ë„¤ìš”!</p>
<p>ë‹¤ë§Œ ì§€êµ¬ë³¸ì„ ëŒë¦´ ë•Œë„ ë‚˜ë¼ê°€ ì„ íƒëœë‹¤ëŠ” ê²Œ ê±°ìŠ¬ë¦½ë‹ˆë‹¤. ë˜ ë‚˜ë¼ë¥¼ ì„ íƒí•˜ê³  ì§€êµ¬ë³¸ì„ ëŒë¦¬ë©´ í•´ë‹¹ ì„ íƒì´ í’€ë ¤ë²„ë¦¬ë„¤ìš”.</p>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ê²ƒê¹Œì§€ ê³ ì³ë´…ì‹œë‹¤. 2ê°€ì§€ ì •ë„ë¥¼ í™•ì¸í•˜ë©´ ì¶©ë¶„í•  ê²ƒ ê°™ë„¤ìš”. í•˜ë‚˜ëŠ” í¬ì¸í„°ë¥¼ ëˆ„ë¥¸ í›„ ë–¼ê¸°ê¹Œì§€ ì–¼ë§ˆë‚˜ ì‹œê°„ì´ í˜ë €ëŠ”ì§€ë¥¼ í™•ì´í•˜ëŠ” ê²ƒì´ê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” í¬ì¸í„°ê°€ ì›€ì§ì˜€ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ë‹ˆë‹¤. ë§ˆìš°ìŠ¤ë¥¼ ë–¼ëŠ” ë° ì‹œê°„ì´ ì–¼ë§ˆ ì•ˆ ê±¸ë ¸ê³  í¬ì¸í„°ê°€ ì›€ì§ì´ì§€ ì•Šì•˜ë‹¤ë©´ í´ë¦­ìœ¼ë¡œ ê°„ì£¼í•˜ëŠ” ê²ƒì´ì£ .</p>
<pre class="prettyprint showlinemods notranslate lang-js" translate="no">+const maxClickTimeMs = 200;
+const maxMoveDeltaSq = 5 * 5;
+const startPosition = {};
+let startTimeMs;
+
+function recordStartTimeAndPosition(event) {
+  startTimeMs = performance.now();
+  const pos = getCanvasRelativePosition(event);
+  startPosition.x = pos.x;
+  startPosition.y = pos.y;
+}

function getCanvasRelativePosition(event) {
  const rect = canvas.getBoundingClientRect();
  return {
    x: (event.clientX - rect.left) * canvas.width  / rect.width,
    y: (event.clientY - rect.top ) * canvas.height / rect.height,
  };
}

function pickCountry(event) {
  // ì•„ì§ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•˜ì„ ê²½ìš°
  if (!countryInfos) {
    return;
  }

+  // í¬ì¸í„°ë¥¼ ëˆ„ë¥¸ í›„ ë–¼ê¸°ê¹Œì§€ ì¼ì • ì‹œê°„ ì´ìƒ ê±¸ë ¸ë‹¤ë©´
+  // ì„ íƒ ì•¡ì…˜ì´ ì•„ë‹Œ ë“œë˜ê·¸ ì•¡ì…˜ìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
+  const clickTimeMs = performance.now() - startTimeMs;
+  if (clickTimeMs &gt; maxClickTimeMs) {
+    return;
+  }
+
+  // í¬ì¸í„°ê°€ ì›€ì§ì˜€ë‹¤ë©´ ë“œë˜ê·¸ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
+  const position = getCanvasRelativePosition(event);
+  const moveDeltaSq = (startPosition.x - position.x) ** 2 +
+                      (startPosition.y - position.y) ** 2;
+  if (moveDeltaSq &gt; maxMoveDeltaSq) {
+    return;
+  }

-  const position = { x: event.clientX, y: event.clientY };
  const id = pickHelper.pick(position, pickingScene, camera);
  if (id &gt; 0) {
    const countryInfo = countryInfos[id - 1];
    const selected = !countryInfo.selected;
    if (selected &amp;&amp; !event.shiftKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.metaKey) {
      unselectAllCountries();
    }
    numCountriesSelected += selected ? 1 : -1;
    countryInfo.selected = selected;
    setPaletteColor(id, selected ? selectedColor : unselectedColor);
    paletteTexture.needsUpdate = true;
  } else if (numCountriesSelected) {
    unselectAllCountries();
  }
  requestRenderIfNotRequested();
}

function unselectAllCountries() {
  numCountriesSelected = 0;
  countryInfos.forEach((countryInfo) =&gt; {
    countryInfo.selected = false;
  });
  resetPalette();
}

+canvas.addEventListener('pointerdown', recordStartTimeAndPosition);
canvas.addEventListener('pointerup', pickCountry);
</pre>
<p>ì œ ê¸°ì¤€ì—ì„œëŠ” ì´ ì •ë„ë©´ ì¶©ë¶„í•œ <em>ë“¯í•˜ë„¤ìš”</em>.</p>
<p></p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/manual/examples/resources/editor.html?url=/manual/examples/indexed-textures-picking-debounced.html"></iframe></div>
  <a class="threejs_center" href="/manual/examples/indexed-textures-picking-debounced.html" target="_blank">ìƒˆ íƒ­ì—ì„œ ë³´ê¸°</a>
</div>

<p></p>
<p>ì €ëŠ” UX ì „ë¬¸ê°€ê°€ ì•„ë‹ˆë‹ˆ ë” ë‚˜ì€ ë°©ë²•ì´ ìˆì„ ê²½ìš° ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ì´ ê¸€ì´ ì¸ë±ìŠ¤(indexed) ê·¸ë˜í”½ì„ í™œìš©í•˜ê³ , Three.jsì˜ ì‰ì´ë”ë¥¼ ìˆ˜ì •í•´ ê°„ë‹¨í•œ íš¨ê³¼ë¥¼ êµ¬í˜„í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ì¢‹ê² ë„¤ìš”. ì‰ì´ë”ë¥¼ ì‘ì„±í•  ë•Œ ì“´ GLSLì— ëŒ€í•´ ë‹¤ë£¨ê¸°ì—ëŠ” ë„ˆë¬´ ë‚´ìš©ì´ ë°©ëŒ€í•˜ë‹ˆ <a href="post-processing.html">í›„ì²˜ë¦¬ì— ê´€í•œ ê¸€</a>ì— ìˆëŠ” ë§í¬ë¥¼ ì°¸ê³ í•˜ê¸° ë°”ëë‹ˆë‹¤.</p>

        </div>
      </div>
    </div>

  <script src="../resources/prettify.js"></script>
  <script src="../resources/lesson.js"></script>




</body></html>
