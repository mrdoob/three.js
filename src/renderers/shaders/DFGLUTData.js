/**
 * Precomputed DFG LUT for Image-Based Lighting
 * Resolution: 16x16
 * Samples: 1024 per texel
 * Format: RG (2 floats per texel: scale, bias)
 */

import { DataTexture } from '../../textures/DataTexture.js';
import { RGFormat, FloatType, LinearFilter, ClampToEdgeWrapping } from '../../constants.js';

export const DFG_LUT_SIZE = 16;

const DFG_LUT_DATA = new Float32Array([
	0.1470, 0.8519, 0.1626, 0.7874, 0.2353, 0.6387, 0.3565, 0.5191, 0.4790, 0.4148, 0.5824, 0.3256, 0.6637, 0.2533, 0.7254, 0.1969, 0.7709, 0.1538, 0.8035, 0.1213, 0.8261, 0.0968, 0.8408, 0.0784, 0.8496, 0.0645, 0.8537, 0.0539, 0.8543, 0.0457, 0.8521, 0.0393,
	0.3887, 0.6112, 0.3920, 0.6009, 0.4088, 0.5464, 0.4497, 0.4476, 0.5179, 0.3519, 0.5953, 0.2733, 0.6655, 0.2112, 0.7214, 0.1626, 0.7617, 0.1257, 0.7877, 0.0977, 0.8014, 0.0765, 0.8053, 0.0605, 0.8014, 0.0485, 0.7914, 0.0394, 0.7764, 0.0324, 0.7581, 0.0270,
	0.5723, 0.4276, 0.5729, 0.4242, 0.5773, 0.4037, 0.5870, 0.3543, 0.6095, 0.2876, 0.6468, 0.2244, 0.6904, 0.1727, 0.7300, 0.1323, 0.7588, 0.1012, 0.7743, 0.0776, 0.7775, 0.0601, 0.7699, 0.0468, 0.7544, 0.0370, 0.7321, 0.0296, 0.7076, 0.0239, 0.6837, 0.0194,
	0.7089, 0.2910, 0.7087, 0.2899, 0.7087, 0.2819, 0.7065, 0.2583, 0.7062, 0.2201, 0.7136, 0.1766, 0.7299, 0.1371, 0.7489, 0.1052, 0.7617, 0.0801, 0.7640, 0.0610, 0.7558, 0.0468, 0.7381, 0.0363, 0.7168, 0.0283, 0.6923, 0.0223, 0.6619, 0.0177, 0.6283, 0.0142,
	0.8082, 0.1918, 0.8075, 0.1914, 0.8055, 0.1884, 0.7987, 0.1779, 0.7889, 0.1584, 0.7791, 0.1320, 0.7749, 0.1052, 0.7737, 0.0813, 0.7689, 0.0621, 0.7571, 0.0472, 0.7384, 0.0362, 0.7189, 0.0278, 0.6916, 0.0215, 0.6580, 0.0168, 0.6222, 0.0132, 0.5838, 0.0104,
	0.8783, 0.1217, 0.8777, 0.1218, 0.8747, 0.1208, 0.8662, 0.1166, 0.8537, 0.1081, 0.8355, 0.0937, 0.8178, 0.0771, 0.7997, 0.0607, 0.7791, 0.0470, 0.7543, 0.0360, 0.7332, 0.0275, 0.7039, 0.0211, 0.6686, 0.0162, 0.6305, 0.0125, 0.5897, 0.0098, 0.5466, 0.0076,
	0.9262, 0.0738, 0.9257, 0.0740, 0.9225, 0.0740, 0.9147, 0.0731, 0.9008, 0.0697, 0.8799, 0.0630, 0.8552, 0.0539, 0.8245, 0.0437, 0.7896, 0.0344, 0.7615, 0.0266, 0.7288, 0.0205, 0.6914, 0.0157, 0.6508, 0.0120, 0.6079, 0.0093, 0.5613, 0.0071, 0.5138, 0.0056,
	0.9577, 0.0423, 0.9573, 0.0425, 0.9548, 0.0430, 0.9467, 0.0431, 0.9345, 0.0426, 0.9142, 0.0403, 0.8858, 0.0359, 0.8458, 0.0301, 0.8058, 0.0243, 0.7689, 0.0192, 0.7261, 0.0148, 0.6827, 0.0114, 0.6368, 0.0088, 0.5877, 0.0068, 0.5363, 0.0052, 0.4870, 0.0040,
	0.9774, 0.0226, 0.9770, 0.0228, 0.9753, 0.0233, 0.9682, 0.0239, 0.9572, 0.0244, 0.9389, 0.0242, 0.9091, 0.0226, 0.8629, 0.0197, 0.8227, 0.0165, 0.7747, 0.0133, 0.7267, 0.0105, 0.6768, 0.0082, 0.6245, 0.0063, 0.5695, 0.0048, 0.5162, 0.0037, 0.4612, 0.0029,
	0.9889, 0.0111, 0.9887, 0.0112, 0.9872, 0.0116, 0.9810, 0.0122, 0.9712, 0.0129, 0.9557, 0.0135, 0.9246, 0.0132, 0.8815, 0.0123, 0.8366, 0.0107, 0.7833, 0.0088, 0.7283, 0.0071, 0.6726, 0.0056, 0.6135, 0.0043, 0.5556, 0.0034, 0.4962, 0.0026, 0.4397, 0.0020,
	0.9952, 0.0048, 0.9950, 0.0049, 0.9938, 0.0051, 0.9884, 0.0056, 0.9813, 0.0064, 0.9670, 0.0070, 0.9350, 0.0073, 0.8971, 0.0071, 0.8472, 0.0065, 0.7915, 0.0056, 0.7322, 0.0046, 0.6692, 0.0037, 0.6055, 0.0029, 0.5419, 0.0023, 0.4795, 0.0018, 0.4202, 0.0014,
	0.9982, 0.0018, 0.9981, 0.0018, 0.9971, 0.0019, 0.9924, 0.0022, 0.9867, 0.0027, 0.9747, 0.0033, 0.9440, 0.0037, 0.9091, 0.0038, 0.8581, 0.0037, 0.7998, 0.0033, 0.7360, 0.0028, 0.6672, 0.0023, 0.5991, 0.0019, 0.5303, 0.0015, 0.4647, 0.0012, 0.4023, 0.0009,
	0.9995, 0.0005, 0.9994, 0.0005, 0.9990, 0.0006, 0.9949, 0.0008, 0.9901, 0.0010, 0.9784, 0.0013, 0.9518, 0.0016, 0.9170, 0.0019, 0.8668, 0.0019, 0.8075, 0.0018, 0.7401, 0.0016, 0.6675, 0.0014, 0.5933, 0.0011, 0.5206, 0.0009, 0.4508, 0.0007, 0.3862, 0.0006,
	0.9999, 0.0001, 0.9998, 0.0001, 0.9996, 0.0001, 0.9960, 0.0002, 0.9919, 0.0003, 0.9789, 0.0005, 0.9578, 0.0006, 0.9243, 0.0008, 0.8756, 0.0009, 0.8152, 0.0009, 0.7447, 0.0008, 0.6678, 0.0007, 0.5888, 0.0006, 0.5117, 0.0005, 0.4388, 0.0004, 0.3716, 0.0003,
	1.0000, 0.0000, 1.0000, 0.0000, 0.9998, 0.0000, 0.9968, 0.0000, 0.9928, 0.0001, 0.9803, 0.0001, 0.9618, 0.0002, 0.9298, 0.0003, 0.8830, 0.0003, 0.8219, 0.0004, 0.7494, 0.0004, 0.6691, 0.0003, 0.5858, 0.0003, 0.5041, 0.0003, 0.4274, 0.0002, 0.3579, 0.0002,
	1.0000, 0.0000, 1.0000, 0.0000, 0.9999, 0.0000, 0.9971, 0.0000, 0.9938, 0.0000, 0.9833, 0.0000, 0.9654, 0.0000, 0.9349, 0.0001, 0.8894, 0.0001, 0.8289, 0.0001, 0.7545, 0.0001, 0.6708, 0.0001, 0.5834, 0.0001, 0.4974, 0.0001, 0.4173, 0.0001, 0.3457, 0.0001
]);

let dfgLUTTexture = null;

export function getDFGLUT() {
	if ( dfgLUTTexture === null ) {
		dfgLUTTexture = new DataTexture( DFG_LUT_DATA, DFG_LUT_SIZE, DFG_LUT_SIZE, RGFormat, FloatType );
		dfgLUTTexture.minFilter = LinearFilter;
		dfgLUTTexture.magFilter = LinearFilter;
		dfgLUTTexture.wrapS = ClampToEdgeWrapping;
		dfgLUTTexture.wrapT = ClampToEdgeWrapping;
		dfgLUTTexture.generateMipmaps = false;
		dfgLUTTexture.needsUpdate = true;
	}
	return dfgLUTTexture;
}
